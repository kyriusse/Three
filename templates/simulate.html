{% extends "base.html" %}
{% block content %}
<h2>Simulation simple de propagation</h2>
<p>Ajoute une variation de prix à un objet source, puis propage selon la probabilité des liaisons sortantes.</p>

<form method="post" class="row-form">
  <select name="object_id" required>
    {% for obj in objects %}
      <option value="{{ obj['id'] }}">{{ obj['name'] }} ({{ obj['base_price_2025'] }}€)</option>
    {% endfor %}
  </select>
  <input type="number" step="0.01" name="delta" value="1.00" required>
  <button type="submit">Simuler</button>
</form>

{% if results %}
<h3>Résultat (source: {{ selected_name }}, delta: {{ delta }})</h3>
<table>
  <thead><tr><th>Objet</th><th>Prix actuel</th><th>Nouveau prix simulé</th><th>Probabilité</th></tr></thead>
  <tbody>
    {% for row in results %}
      <tr>
        <td>{{ row['name'] }}</td>
        <td>{{ row['old_price'] }}</td>
        <td>{{ row['new_price'] }}</td>
        <td>{{ row['probability'] }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
{% endblock %}
